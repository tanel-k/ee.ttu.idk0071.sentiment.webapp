{"version":3,"sources":["app.js","environment.js","lookup-form.js","lookup-result.js","main.js","messages.js","no-lookup.js","utils.js","web-api.js","resources/index.js","resources/elements/loading-indicator.js"],"names":["App","inject","api","configureRouter","config","router","title","map","route","moduleId","name","debug","testing","LookupForm","ea","created","getBusinessTypes","then","bussinessTypes","types","x","value","code","getCountries","countries","performLookup","publish","countryId","typeId","businessName","navigate","lookupResult","lookupId","isRequesting","LookupResult","subscribe","activate","params","getLookupData","lookupData","getLookupSnapshots","snapshots","snapshotsResult","configure","Promise","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","setRoot","LookupStarted","NoLookup","message","isEmpty","val","trim","latency","longLatency","businessTypes","lookupResponse","business","type","country","averageSentiment","snapshotCount","lookupSnapshots","url","rank","lookupDomain","time","sentiment","trustLevel","WebAPI","getBusinessEntities","setTimeout","resolve","businessEntities","globalResources","nprogress","LoadingIndicator","defaultValue","on","loadingChanged","newValue","done"],"mappings":"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","file":"app-bundle.js","sourcesContent":["import {WebAPI} from './web-api';\n\nexport class App {\n  static inject() { return [WebAPI]; }\n\n  constructor(api) {\n    this.api = api;\n  }\n\n  configureRouter(config, router) {\n    config.title = 'Sentimental.ly';\n    config.map([\n      { route: '', moduleId: 'no-lookup', title: 'Lookups'},\n      { route: 'lookups/:lookupId', moduleId: 'lookup-result', name: 'lookups' }\n    ]);\n\n    this.router = router;\n  }\n}\n","export default {\r\n  debug: true,\r\n  testing: true\r\n};\r\n","/**\n * Created by Tanel.Prikk on 2/21/2017.\n */\nimport {WebAPI} from './web-api';\nimport {isEmpty} from './utils';\nimport {Router} from 'aurelia-router';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {LookupStarted} from './messages';\n\nexport class LookupForm {\n\tstatic inject() { return [WebAPI, Router, EventAggregator] };\n\n\tconstructor(api, router, ea) {\n\t\tthis.api = api;\n\t\tthis.router = router;\n\t\tthis.ea = ea;\n\t}\n\n\tcreated() {\n\t\tthis.api.getBusinessTypes().then(types => {\n\t\t\t\tthis.bussinessTypes = types.map(x => {\n\t\t\t\t\treturn { name: x.name, value: x.code };\n\t\t\t\t});\n\t\t\t});\n\n\t\tthis.api.getCountries().then(countries => {\n\t\t\t\tthis.countries = countries.map(x => {\n\t\t\t\t\treturn { name: x.name, value: x.code }\n\t\t\t});\n\t\t});\n\t}\n\n\tget canLookup() {\n\t\treturn this.typeId\n\t\t\t&& this.countryId\n\t\t\t&& !isEmpty(this.businessName)\n\t\t\t&& !this.api.isRequesting;\n\t}\n\n  performLookup() {\n    this.ea.publish(new LookupStarted());\n\n    this.api.performLookup({\n\t\t  countryId: this.countryId,\n      typeId: this.typeId,\n      name: this.businessName\n    }).then(lookupResult => {\n      this.router.navigate(\"lookups/\" + lookupResult.lookupId);\n    });\n\t}\n}\n","/**\n * Created by Tanel.Prikk on 2/21/2017.\n */\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {LookupStarted} from './messages';\nimport {WebAPI} from './web-api';\n\nexport class LookupResult {\n  static inject() { return [WebAPI, EventAggregator]; }\n\n  constructor(api, ea){\n    this.api = api;\n    this.ea = ea;\n    this.ea.subscribe(LookupStarted, msg =>  {\n      // clear old results here\n    });\n  }\n\n  activate(params) {\n    this.api.getLookupData(params.lookupId).then(lookupData => {\n      this.lookupData = lookupData;\n    });\n\n    return this.api.getLookupSnapshots(params.lookupId).then(snapshotsResult => {\n      this.snapshots = snapshotsResult.snapshots;\n    });\n  }\n}\n","import environment from './environment';\r\n\r\n//Configure Bluebird Promises.\r\nPromise.config({\r\n  warnings: {\r\n    wForgottenReturn: false\r\n  }\r\n});\r\n\r\nexport function configure(aurelia) {\r\n  aurelia.use\r\n    .standardConfiguration()\r\n    .feature('resources');\r\n\r\n  if (environment.debug) {\r\n    aurelia.use.developmentLogging();\r\n  }\r\n\r\n  if (environment.testing) {\r\n    aurelia.use.plugin('aurelia-testing');\r\n  }\r\n\r\n  aurelia.start().then(() => aurelia.setRoot());\r\n}\r\n","/**\n * Created by Tanel.Prikk on 2/21/2017.\n */\nexport class LookupStarted {\n  constructor(){\n   // pass\n  }\n}\n","/**\n * Created by Tanel.Prikk on 2/21/2017.\n */\nexport class NoLookup {\n  constructor() {\n    this.message = \"Use the form to see what other people think.\";\n  }\n}\n","/**\n * Created by Tanel.Prikk on 2/21/2017.\n */\nexport function isEmpty(val) {\n  return !val || !val.trim();\n}\n","/**\n * Created by Tanel.Prikk on 2/21/2017.\n */\nlet latency = 500;\nlet longLatency = 1000;\n\nlet businessTypes = [\n\t{\n\t\tcode: 1,\n\t\tname: \"Transport\"\n\t},\n\t{\n\t\tcode: 2,\n\t\tname: \"E-commerce\"\n\t},\n\t{\n\t\tcode: 3,\n\t\tname: \"Banking\"\n\t}\n];\n\nlet countries = [\n\t{\n\t\tcode: \"UK\",\n\t\tname: \"United Kingdom\"\n\t},\n\t{\n\t\tcode: \"AUS\",\n\t\tname: \"Australia\"\n\t},\n];\n\nlet lookupResponse = {\n  lookupId: 1\n};\n\nlet lookupData = {\n  business: {\n    type: \"Transport\",\n    country: \"United Kingdom\",\n    name: \"Dummy test\"\n  },\n  averageSentiment: \"Neutral\",\n  snapshotCount: 5\n};\n\nlet lookupSnapshots = {\n  snapshots: [\n    {\n      url: \"http://bizreviews.com/32352\",\n      title: \"Dummy Review 1\",\n      rank: 1,\n      lookupDomain: \"Google\",\n      time: \"2012-04-23T18:25:43.511Z\",\n      sentiment: \"Neutral\",\n      trustLevel: 0.067\n    },\n    {\n      url: \"http://xreviews.com/31152\",\n      title: \"Dummy Review 2\",\n      rank: 2,\n      lookupDomain: \"Google\",\n      time: \"2012-04-23T18:25:43.511Z\",\n      sentiment: \"Neutral\",\n      trustLevel: 0.017\n    },\n    {\n      url: \"http://xreviews.com/31152\",\n      title: \"Dummy Review 3\",\n      rank: 3,\n      lookupDomain: \"Google\",\n      time: \"2012-04-23T18:25:43.511Z\",\n      sentiment: \"Positive\",\n      trustLevel: 0.017\n    },\n    {\n      url: \"http://xreviews.com/31152\",\n      title: \"Dummy Review 4\",\n      rank: 4,\n      lookupDomain: \"Google\",\n      time: \"2012-04-23T18:25:43.511Z\",\n      sentiment: \"Negative\",\n      trustLevel: 0.017\n    },\n    {\n      url: \"http://xreviews.com/31152\",\n      title: \"Dummy Review 5\",\n      rank: 5,\n      lookupDomain: \"Google\",\n      time: \"2012-04-23T18:25:43.511Z\",\n      sentiment: \"Positive\",\n      trustLevel: 0.017\n    }\n  ]\n};\n\n/**\n * TODO: Replace mock API with actual web service\n */\nexport class WebAPI {\n\tisRequesting = false;\n\n\tgetBusinessEntities() {\n\t\tthis.isRequesting = true;\n\t\treturn new Promise(resolve => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tresolve(businessEntities);\n\t\t\t\tthis.isRequesting = false;\n\t\t\t}, latency);\n\t\t});\n\t}\n\n\tgetCountries() {\n\t\tthis.isRequesting = true;\n\t\treturn new Promise(resolve => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tresolve(countries);\n\t\t\t\tthis.isRequesting = false;\n\t\t\t}, latency);\n\t\t});\n\t}\n\n\tgetBusinessTypes() {\n\t\tthis.isRequesting = true;\n\t\treturn new Promise(resolve => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tresolve(businessTypes);\n\t\t\t\tthis.isRequesting = false;\n\t\t\t}, latency);\n\t\t});\n\t}\n\n\tgetLookupSnapshots(lookupId) {\n\t\tthis.isRequesting = true;\n\t\treturn new Promise(resolve => {\n        setTimeout(() => {\n            resolve(lookupSnapshots);\n            this.isRequesting = false;\n        }, latency);\n      });\n  }\n\n  getLookupData(lookupId) {\n    this.isRequesting = true;\n    return new Promise(resolve => {\n        setTimeout(() => {\n          resolve(lookupData);\n          this.isRequesting = false;\n        }, latency);\n      });\n  }\n\n  performLookup(business) {\n\t  this.isRequesting = true;\n\t  return new Promise(resolve => {\n\t    setTimeout(() => {\n\t      resolve(lookupResponse);\n\t      this.isRequesting = false;\n      }, longLatency);\n    });\n  }\n}\n","export function configure(config) {\n\tconfig.globalResources(['./elements/loading-indicator']);\n}\n","/**\n * Created by Tanel.Prikk on 2/21/2017.\n */\nimport * as nprogress from 'nprogress';\nimport {bindable, noView, decorators} from 'aurelia-framework';\n\nexport let LoadingIndicator = decorators(\n\tnoView(['nprogress/nprogress.css']),\n\tbindable({name: 'loading', defaultValue: false})\n).on(class {\n\tloadingChanged(newValue){\n\t\tif (newValue) {\n\t\t\tnprogress.start();\n\t\t} else {\n\t\t\tnprogress.done();\n\t\t}\n\t}\n});\n"],"sourceRoot":"../src"}